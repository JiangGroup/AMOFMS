<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Mapping &mdash; AMOFMS 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1165ae04" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Identify Parameters for Optimization" href="Identify_parameters.html" />
    <link rel="prev" title="1. Determine Coarse-Grained Force Field" href="Determine_CGFF.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AMOFMS
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../usage.html">Usage Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Determine_CGFF.html">1. Determine Coarse-Grained Force Field</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dsgpm-tp-for-martini2-cg-mapping">DSGPM-TP for MARTINI2 CG Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-topology-dict">System Topology (dict)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecules">Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lennard-jones-terms">Lennard-Jones Terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coarse-grained-model">Coarse-Grained Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Identify_parameters.html">3. Identify Parameters for Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Define_obj.html">4. Define Objective Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Select_optimizer.html">5. Select Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Run.html">6. Run Optimization and Save Log</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changlog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about_amofms.html">About AMOFMS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AMOFMS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../usage.html">Usage Guide</a></li>
      <li class="breadcrumb-item active">2. Mapping</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/usage/Mapping.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mapping">
<span id="id1"></span><h1>2. Mapping<a class="headerlink" href="#mapping" title="Link to this heading"></a></h1>
<section id="dsgpm-tp-for-martini2-cg-mapping">
<h2>DSGPM-TP for MARTINI2 CG Mapping<a class="headerlink" href="#dsgpm-tp-for-martini2-cg-mapping" title="Link to this heading"></a></h2>
<p>Map the molecules to their coarse-grained representations according to the chosen force field rules. AMOFMS can utilize <strong>DSGPM-TP</strong> to map molecules to MARTINI2 representation (for more information about DSGPM-TP model, please see the original literature). There are two ways to use it:</p>
<p><strong>Shell Command</strong>:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>TP_MARTINI2<span class="w"> </span>--smiles<span class="w"> </span><span class="s1">&#39;CCCCCCCCCCCCCCCC(=O)OCC(COP(=O)([O-])OCC[N+](C)(C)C)OC(=O)CCCCCCCC=CCCCCCCCC&#39;</span><span class="w"> </span>--num_bead<span class="w"> </span><span class="m">12</span><span class="w"> </span>--json_output<span class="w"> </span>./
</pre></div>
</div>
</div></blockquote>
<p>this process will generate <a class="reference external" href="/home/xiaoyedi/data/work/research/ML_DL/Autopara_CG/program/package_log/repository_test/doc/source/example/POPC/popc.png">mapping result picture (.png)</a> and <a class="reference external" href="/home/xiaoyedi/data/work/research/ML_DL/Autopara_CG/program/package_log/repository_test/doc/source/example/POPC/popc.json">mapping result JSON file (.json)</a>.</p>
<img alt="POPC CG Mapping predicted by DSGPM-TP model" src="../_images/popc.png" />
<p><strong>Python Script</strong> (Full script is in <a class="reference external" href="/home/xiaoyedi/data/work/research/ML_DL/Autopara_CG/program/package_log/repository_test/doc/source/example/POPC/run_mapping.py">run_mapping.py</a>.):</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AMOFMS.FGMappingToCG</span> <span class="kn">import</span> <span class="n">MappingToCGfromDSGPM_TP</span><span class="p">,</span> <span class="n">MappingItem</span>
<span class="kn">from</span> <span class="nn">AMOFMS.CGForceFieldParameters</span> <span class="kn">import</span> <span class="n">InitCGForceFieldParameters</span><span class="p">,</span> <span class="n">generate_system_top</span>
<span class="kn">from</span> <span class="nn">opt_settings</span> <span class="kn">import</span> <span class="n">opt_settings</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span>
<span class="c1"># molecule 1</span>
    <span class="p">{</span>
        <span class="s1">&#39;molecule name&#39;</span><span class="p">:</span> <span class="s1">&#39;POPC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;molecular form&#39;</span><span class="p">:</span> <span class="s1">&#39;sml&#39;</span><span class="p">,</span>  <span class="c1"># sml or pdb; if use .pdb, please add &#39;pdb file root&#39;=&#39;path/to/your/pdb/file&#39;</span>
        <span class="s1">&#39;smiles&#39;</span><span class="p">:</span> <span class="s1">&#39;CCCCCCCCCCCCCCCC(=O)OCC(COP(=O)([O-])OCC[N+](C)(C)C)OC(=O)CCCCCCCC=CCCCCCCCC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;number of mapping beads&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="s1">&#39;mapping output folder&#39;</span><span class="p">:</span> <span class="s1">&#39;./mapping_test/POPC/mapping/POPC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;number of atom in molecule&#39;</span><span class="p">:</span> <span class="mi">134</span><span class="p">,</span>  <span class="c1"># including H atom</span>
        <span class="s1">&#39;number of molecule in system&#39;</span><span class="p">:</span> <span class="mi">384</span><span class="p">,</span>
        <span class="s1">&#39;residue name&#39;</span><span class="p">:</span> <span class="s1">&#39;POPC&#39;</span><span class="p">,</span>

        <span class="c1"># split 134 atom to 12 list corresponding to 12 cg bead(group)</span>
        <span class="s1">&#39;aa_group_list&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">],</span>
                          <span class="o">...</span><span class="p">,</span>
                          <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
                          <span class="p">]</span>
    <span class="p">},</span>

    <span class="c1"># moleucele2</span>
    <span class="p">{</span><span class="s1">&#39;molecule name&#39;</span><span class="p">:</span> <span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span> <span class="o">...</span>
<span class="p">]</span>

<span class="n">all_cg_molecule_top</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
    <span class="n">mol_mapping</span> <span class="o">=</span> <span class="n">MappingToCGfromDSGPM_TP</span><span class="p">(</span><span class="n">mol_name</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;molecule name&#39;</span><span class="p">],</span>
                                           <span class="n">mol_form</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;molecular form&#39;</span><span class="p">],</span>
                                           <span class="n">smiles</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">],</span>
                                           <span class="n">CG_num_bead</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;number of mapping beads&#39;</span><span class="p">],</span>
                                           <span class="n">output_dir</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;mapping output folder&#39;</span><span class="p">],</span>
                                           <span class="n">CGmodel</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;coarse-grained model&#39;</span><span class="p">]</span>
                                           <span class="p">)</span>

    <span class="n">FF_parameter_item</span> <span class="o">=</span> <span class="n">InitCGForceFieldParameters</span><span class="p">(</span><span class="n">mapping_item</span><span class="o">=</span><span class="n">mol_mapping</span><span class="o">.</span><span class="n">get_mapping_item</span><span class="p">(),</span>
                                                   <span class="n">num_mols</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;number of molecule in system&#39;</span><span class="p">],</span>
                                                   <span class="n">setbond</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;opt bond&#39;</span><span class="p">],</span>
                                                   <span class="n">setangle</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;opt angle&#39;</span><span class="p">],</span>
                                                   <span class="n">setdihedral</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;opt dihedral&#39;</span><span class="p">],</span>
                                                   <span class="p">)</span>

    <span class="k">if</span> <span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;eq bond from fg&#39;</span><span class="p">]:</span>
        <span class="n">FF_parameter_item</span><span class="o">.</span><span class="n">set_bond_parameters</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;fine-grained topology file&#39;</span><span class="p">],</span>
                                              <span class="n">traj</span><span class="o">=</span><span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;fine-grained trajectory file&#39;</span><span class="p">],</span>
                                              <span class="n">num_atom_with_H</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;number of atom in molecule&#39;</span><span class="p">],</span>
                                              <span class="n">num_mol</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;number of molecule in system&#39;</span><span class="p">],</span>
                                              <span class="n">res_name</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;residue name&#39;</span><span class="p">],</span>
                                              <span class="n">group_list</span><span class="o">=</span><span class="n">molecule</span><span class="p">[</span><span class="s1">&#39;aa_group_list&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;eq angle from fg&#39;</span><span class="p">]:</span>
        <span class="o">...</span><span class="p">,</span>
    <span class="k">if</span> <span class="n">opt_settings</span><span class="p">[</span><span class="s1">&#39;eq dihedral from fg&#39;</span><span class="p">]:</span>
        <span class="o">...</span><span class="p">,</span>
    <span class="n">cg_molecule_top</span> <span class="o">=</span> <span class="n">FF_parameter_item</span><span class="o">.</span><span class="n">generate_cg_ff_parameters_item</span><span class="p">()</span>
    <span class="n">all_cg_molecule_top</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cg_molecule_top</span><span class="p">)</span>

<span class="n">system_topology</span> <span class="o">=</span> <span class="n">generate_system_top</span><span class="p">(</span><span class="n">mols</span><span class="o">=</span><span class="n">all_cg_molecule_top</span><span class="p">,</span> <span class="n">num_mols</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>The <cite>opt_settings.py</cite> is in <a class="reference external" href="/home/xiaoyedi/data/work/research/ML_DL/Autopara_CG/program/package_log/repository_test/doc/source/example/POPC/opt_settings.py">here</a>. Use the <a class="reference internal" href="../api/CGForceFieldParameters/CGForceFieldParameters.html#generate-system-top"><span class="std std-ref">generate_system_top</span></a> function to convert all molecules to the <cite>system_topology</cite> dictionary format. The <cite>system_topology</cite> can be found in <a class="reference external" href="/home/xiaoyedi/data/work/research/ML_DL/Autopara_CG/program/package_log/repository_test/doc/source/example/POPC/opt_init_para.py">opt_init_para.py</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To initially obtain equilibrium bond lengths from all-atom (AA) molecular dynamics simulations, the corresponding AA trajectory and topology files should be provided.</p>
</div>
</section>
<section id="system-topology-dict">
<h2>System Topology (dict)<a class="headerlink" href="#system-topology-dict" title="Link to this heading"></a></h2>
<p>Then, the <cite>system_topology</cite> (dict) will be obtained:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_topology</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;molecules&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="p">{</span><span class="s1">&#39;mol_name&#39;</span><span class="p">:</span> <span class="s1">&#39;POPC&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span> <span class="s1">&#39;Q0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">],</span>
 <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
 <span class="s1">&#39;charge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
 <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">57.1146</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">42.08</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">58.0357</span><span class="p">,</span> <span class="mf">57.0278</span><span class="p">,</span> <span class="mf">123.0234</span><span class="p">,</span> <span class="mf">73.1372</span><span class="p">,</span> <span class="mf">70.1334</span><span class="p">,</span> <span class="mf">54.091</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">57.1146</span><span class="p">],</span>
 <span class="s1">&#39;num_mols&#39;</span><span class="p">:</span> <span class="mi">384</span><span class="p">,</span>
 <span class="s1">&#39;fg_groups&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">],</span>
               <span class="o">...</span><span class="p">,</span>
               <span class="p">[</span><span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">]],</span>

 <span class="s1">&#39;bond_parameters&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.4656</span><span class="p">,</span> <span class="mf">1250.0</span><span class="p">],</span>
                      <span class="o">...</span><span class="p">,</span>
                     <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.4655</span><span class="p">,</span> <span class="mf">1250.0</span><span class="p">]},</span>

 <span class="s1">&#39;angle_parameters&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span> <span class="p">[</span><span class="mf">105.2565</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">],</span>
                       <span class="o">...</span><span class="p">,</span>
                      <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">[</span><span class="mf">147.8506</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]}},</span>

<span class="p">{</span><span class="s1">&#39;mol_name&#39;</span><span class="p">:</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span><span class="p">,</span> <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P4&#39;</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;charge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">],</span> <span class="s1">&#39;num_mols&#39;</span><span class="p">:</span> <span class="mi">3284</span><span class="p">},</span>

<span class="p">{</span><span class="s1">&#39;mol_name&#39;</span><span class="p">:</span> <span class="s1">&#39;FW&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span><span class="p">,</span> <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BP4&#39;</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;charge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">],</span> <span class="s1">&#39;num_mols&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">}],</span>

<span class="s1">&#39;lj_cross_terms&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
                   <span class="o">...</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]},</span>
 <span class="s1">&#39;cgmodel&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>The <cite>system_topology</cite> dictionary contains detailed information about the molecular system used in the simulation. It includes descriptions of molecules, their interactions, and parameters for coarse-grained (CG) models. The following sections describe the structure and components of the <cite>system_topology</cite>, includeing <cite>molecules</cite>, <cite>lj_cross_terms</cite> and <cite>cgmodel</cite>.</p>
</section>
<section id="molecules">
<h2>Molecules<a class="headerlink" href="#molecules" title="Link to this heading"></a></h2>
<p>Each molecule in the system is represented as a dictionary within the <cite>molecules</cite> list. The dictionary contains the following keys:</p>
<ul class="simple">
<li><p><strong>mol_name</strong>: Name of the molecule (e.g., ‘POPC’).</p></li>
<li><p><strong>model</strong>: Coarse-grained model used (e.g., ‘MARTINI2’).</p></li>
<li><p><strong>types</strong>: List of bead types in the molecule.</p></li>
<li><p><strong>id</strong>: List of unique IDs for each bead.</p></li>
<li><p><strong>charge</strong>: List of charges for each bead.</p></li>
<li><p><strong>mass</strong>: List of masses for each bead.</p></li>
<li><p><strong>num_mols</strong>: Number of molecules of this type in the system.</p></li>
<li><p><strong>fg_groups</strong>: Nested lists where each sublist contains the IDs of beads that belong to a specific CG group.</p></li>
<li><p><strong>bond_parameters</strong>: Dictionary where keys are tuples representing bonded bead pairs, and values are lists containing bond length and force constant.</p></li>
<li><p><strong>angle_parameters</strong>: Dictionary where keys are tuples representing bonded bead triplets (angles), and values are lists containing angle value and force constant.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;mol_name&#39;</span><span class="p">:</span> <span class="s1">&#39;POPC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span> <span class="s1">&#39;Q0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
    <span class="s1">&#39;charge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">57.1146</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">42.08</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">58.0357</span><span class="p">,</span> <span class="mf">57.0278</span><span class="p">,</span> <span class="mf">123.0234</span><span class="p">,</span> <span class="mf">73.1372</span><span class="p">,</span> <span class="mf">70.1334</span><span class="p">,</span> <span class="mf">54.091</span><span class="p">,</span> <span class="mf">56.1067</span><span class="p">,</span> <span class="mf">57.1146</span><span class="p">],</span>
    <span class="s1">&#39;num_mols&#39;</span><span class="p">:</span> <span class="mi">384</span><span class="p">,</span>
    <span class="s1">&#39;fg_groups&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s1">&#39;bond_parameters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.4656</span><span class="p">,</span> <span class="mf">1250.0</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.4655</span><span class="p">,</span> <span class="mf">1250.0</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;angle_parameters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span> <span class="p">[</span><span class="mf">105.2565</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">[</span><span class="mf">147.8506</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="lennard-jones-terms">
<h2>Lennard-Jones Terms<a class="headerlink" href="#lennard-jones-terms" title="Link to this heading"></a></h2>
<p>The <cite>lj_cross_terms</cite> dictionary contains parameters for Lennard-Jones interactions between types of beads. Each key is a tuple of bead types, and each value is a list containing the epsilon (depth of the potential well) and sigma (finite distance at which the inter-particle potential is zero) parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="c1">#  (bead1, bead2):[sigma(nm), epsilon(kJ/mol)]</span>
    <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
    <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;QA&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.62</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
    <span class="o">...</span>
    <span class="p">(</span><span class="s1">&#39;Q0&#39;</span><span class="p">,</span> <span class="s1">&#39;Q0&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
    <span class="p">(</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="coarse-grained-model">
<h2>Coarse-Grained Model<a class="headerlink" href="#coarse-grained-model" title="Link to this heading"></a></h2>
<p>The <cite>cgmodel</cite> key specifies the coarse-grained model (<cite>MARTINI2</cite>, <cite>MARTINI3</cite> and <cite>SPICA</cite>) used for the system.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;cgmodel&#39;</span><span class="p">:</span> <span class="s1">&#39;MARTINI2&#39;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Determine_CGFF.html" class="btn btn-neutral float-left" title="1. Determine Coarse-Grained Force Field" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Identify_parameters.html" class="btn btn-neutral float-right" title="3. Identify Parameters for Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jiang Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>