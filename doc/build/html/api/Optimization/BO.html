<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BayesianOptimizer &mdash; AMOFMS 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=1165ae04" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Individual" href="GO.html" />
    <link rel="prev" title="Particle" href="PSO.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            AMOFMS
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example.html">Example</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../API.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../FGMappingToCG.html">FGMappingToCG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CGForceFieldParameters.html">CGForceFieldParameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CGPropertiesFromFGSimulation.html">CGPropertiesFromFGSimulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ObjectiveFunction.html">ObjectiveFunction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Optimization.html">Optimization</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="LossRecorder.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossRecorder</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="OptParametersProcess.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptParametersProcess</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="PSO.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="PSO.html#particleswarmoptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleSwarmOptimizer</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GO.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">Individual</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="GO.html#geneticoptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneticOptimizer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="SIMPLEX.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimplexOptimizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changlog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about_amofms.html">About AMOFMS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">AMOFMS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../API.html">Python API</a></li>
          <li class="breadcrumb-item"><a href="../Optimization.html">Optimization</a></li>
      <li class="breadcrumb-item active"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/Optimization/BO.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bayesianoptimizer">
<span id="id1"></span><h1><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code><a class="headerlink" href="#bayesianoptimizer" title="Link to this heading"></a></h1>
<p>Implements Bayesian Optimization using Gaussian Processes (GP) to find the minimum of an objective function.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">objective_function</span></code> (callable): The objective function to be minimized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds</span></code> (list of tuples): The bounds for each dimension of the input parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_initial_points</span></code> (int): The number of initial random samples.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_iter</span></code> (int): The number of iterations to perform after initial sampling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opt_folder</span></code> (str): The directory where optimization artifacts will be stored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recorder</span></code> (LossRecorder): An instance of the LossRecorder class to track losses and optimization parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_no_improvement_iters</span></code> (int): Maximum number of iterations without improvement for convergence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">converged_threshold</span></code> (float): Convergence threshold for optimization termination.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gp</span></code> (GaussianProcessRegressor): The Gaussian Process model used for function approximation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_samples</span></code> (list): List of sampled input parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y_samples</span></code> (list): List of objective function values corresponding to input samples.</p></li>
</ul>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">objective_function,</span> <span class="pre">bounds,</span> <span class="pre">opt_folder,</span> <span class="pre">n_initial_points=5,</span> <span class="pre">max_iter=25,</span> <span class="pre">max_no_improvement_iters=8,</span> <span class="pre">converged_threshold=1e-6)</span></code>: Initializes the BayesianOptimizer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_initial_points(self)</span></code>: Randomly samples initial points within the defined bounds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_single_point(self,</span> <span class="pre">idx)</span></code>: Samples a single initial point within the bounds (used in parallel sampling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_initial_points_mpi(self,</span> <span class="pre">max_processes=1)</span></code>: Samples initial points in parallel using MPI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expected_improvement(self,</span> <span class="pre">x)</span></code>: Calculates the Expected Improvement at a given point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optimize(self,</span> <span class="pre">initial_sample_mpi=False,</span> <span class="pre">initial_sample_max_processes=1)</span></code>: Executes Bayesian Optimization.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code> class implements Bayesian Optimization, a technique for optimizing expensive-to-evaluate functions by building a probabilistic surrogate model (GP) of the objective function and iteratively selecting points to evaluate based on an acquisition function (expected improvement).</p>
<p>The attributes of this class include the objective function, search space bounds, initial sample size, number of iterations, optimization folder, convergence parameters, GP model, and lists to store sampled points and function values.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sample_initial_points</span></code> method randomly samples initial points within the bounds, while <code class="docutils literal notranslate"><span class="pre">sample_initial_points_mpi</span></code> allows parallel sampling using MPI.</p>
<p><code class="docutils literal notranslate"><span class="pre">expected_improvement</span></code> computes the Expected Improvement acquisition function at a given point, guiding the selection of the next point to evaluate.</p>
<p>The main optimization process is performed by the <code class="docutils literal notranslate"><span class="pre">optimize</span></code> method, which iteratively fits the GP model, selects points to evaluate, updates the GP with new observations, and records optimization progress.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">recorder</span></code> attribute enables tracking of optimization progress, including iteration details and convergence metrics, facilitating analysis and troubleshooting.</p>
<p><code class="docutils literal notranslate"><span class="pre">sample_single_point</span></code> method is used internally by <code class="docutils literal notranslate"><span class="pre">sample_initial_points_mpi</span></code> for parallel sampling of initial points.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PSO.html" class="btn btn-neutral float-left" title="Particle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="GO.html" class="btn btn-neutral float-right" title="Individual" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jiang Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>